{% extends "companies/_company_site_base.html" %}
{% load i18n crispy_forms_tags guardian_tags %}

{% block title %}
{% trans 'Company Sites Management' %} |
{% endblock %}

{% block breadcrumbs %}
<a href="{% url 'company_list' %}">{% trans "Company list" %}</a> &gt; <a href="{% url 'company_edit' company.id %}">{{ company.name }}</a> &gt; {% trans "Company's Sites" %}
{% endblock %}

{% block page-title %}
    {% trans "Company's Sites Management" %}
{% endblock %}

{% block main %}

{{ block.super }}

{% get_obj_perms request.user for company as "company_perms" %}

<table id="entity_list_table" class="infotable datatable">
    <thead>
        <tr>
            <th>{% trans "First name" %}</th>
            <th>{% trans 'Last name' %}</th>
            <th>{% trans 'City' %}</th>
            <th>{% trans 'Actions' %}</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td colspan="4" class="dataTables_empty">{% trans "Loading data from server" %}</td> 
        </tr>
    </tbody>
</table>



{% comment %}
<div class="tab-content" ng-controller="CompanySitesController">
    <div class="tab-pane active" id="sites">
        <div >
            <div class="gridStyle" ng-grid="CompanySitesGridOptions"></div>
        </div>
    </div>
</div>
{% endcomment %}
{% endblock %}

{% comment %}<ul id="sites-tab" class="nav nav-tabs">
    <li class="active"><a href="#sites" data-toggle="tab">{% trans "Sites" %}</a></li>
    <li><a href="#add-site" data-toggle="tab">{% trans "Add Site" %}</a></li>
</ul>
<div class="tab-content" ng-controller="CompanySitesController">
    <div class="tab-pane active" id="sites">
        <div >
            <div class="gridStyle" ng-grid="CompanySitesGridOptions"></div>
        </div>
    </div>
    <div class="tab-pane" id="add-site">
        <form name="newsite" novalidate class="form-horizontal" action="" method="post">{% csrf_token %}
        {% crispy form form.helper %}
        </form>
    </div>
</div>
{% endcomment %}

{% block javascript %}
    {{ block.super }}
    var COMPANY_ID = {{ company.id }};
    <script src="{{ STATIC_URL }}theme/components/datatables/media/js/jquery.dataTables.js" language="javascript" type="text/javascript"></script>
    <script charset="utf-8" type="text/javascript">
    $(document).ready(function() {
        $('#entity_list_table').dataTable( {
            "oLanguage": {
            "sProcessing":   "{% trans 'Processing...' %}",
            "sLengthMenu":   "{% trans 'Show _MENU_ entries' %}",
            "sZeroRecords":  "{% trans 'No matching records found' %}",
            "sInfo":         "{% trans 'Showing _START_ to _END_ of _TOTAL_ entries' %}",
            "sInfoEmpty":    "{% trans 'Showing 0 to 0 of 0 entries' %}",
            "sInfoFiltered": "{% trans '(filtered from _MAX_ total entries)' %}",
            "sInfoPostFix":  "",
            "sSearch":       "{% trans 'Search:' %}",
            "sUrl":          "",
            "oPaginate": {
                "sFirst":    "{% trans 'First' %}",
                "sPrevious": "{% trans 'Previous' %}",
                "sNext":     "{% trans 'Next' %}",
                "sLast":     "{% trans 'Last' %}"
            }
         },
         "sDom":'lfriptip',
         "bServerSide": true,
         "sAjaxSource": "{% url 'companies:api-company-site-list' company.pk %}",
         "aoColumnDefs": [
                { "bSortable": false, "aTargets": [2] },
                {
                    "aTargets":[3], // Your actual column number goes here
                    "fnCreatedCell": function(nTd, sData, oData, iRow, iCol)
                    {
                        $(nTd).css('text-align', 'center');
                    },
                    "mData": null,
                    "mRender": function( data, type, full) {
                        return '<td><a href="#" class="YOUR-ACTION"><i class="aug-accept" rel="tooltip" data-placement="right" title="ActionType"></i></a></td>';
                    }
                }
            ]
    });
});
</script>
{% endblock %}

