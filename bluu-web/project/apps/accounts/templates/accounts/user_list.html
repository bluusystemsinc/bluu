{% extends "base.html" %}

{% load i18n guardian_tags %}

{% block title %}
{% trans 'User list' %} |
{% endblock %}

{% block css %}
    <link rel="stylesheet" href="{{ STATIC_URL }}theme/components/datatables/media/css/jquery.dataTables.css" />
    {{ block.super }}
{% endblock %}

{% block javascript %}
    {{ block.super }}
<script src="{{ STATIC_URL }}theme/components/datatables/media/js/jquery.dataTables.js" language="javascript" type="text/javascript"></script>
<script charset="utf-8" type="text/javascript">
    $(document).ready(function() {
        $('#entity_list_table').dataTable( {
            "oLanguage": {
            "sProcessing":   "{% trans 'Processing...' %}",
            "sLengthMenu":   "{% trans 'Show _MENU_ entries' %}",
            "sZeroRecords":  "{% trans 'No matching records found' %}",
            "sInfo":         "{% trans 'Showing _START_ to _END_ of _TOTAL_ entries' %}",
            "sInfoEmpty":    "{% trans 'Showing 0 to 0 of 0 entries' %}",
            "sInfoFiltered": "{% trans '(filtered from _MAX_ total entries)' %}",
            "sInfoPostFix":  "",
            "sSearch":       "{% trans 'Search:' %}",
            "sUrl":          "",
            "oPaginate": {
                "sFirst":    "{% trans 'First' %}",
                "sPrevious": "{% trans 'Previous' %}",
                "sNext":     "{% trans 'Next' %}",
                "sLast":     "{% trans 'Last' %}"
            }
         },
         "sDom":'lfriptip',
         "aoColumnDefs": [
                { "bSortable": false, "aTargets": [2] }
            ]
    });
});

</script>
{% endblock %}

{% block content %}
    <div class="page-header content-wrapper">
        <h1 class="form-label">{% trans "User list" %}</h1>
    </div>

    {% if perms.accounts.add_bluuuser %}
    <ul class="nav nav-pills nav-stacked">
        <li><a href="{% url 'bluuuser_add' %}">{% trans "Add user" %}</a></li>
    </ul>
    {% endif %}

    {% if object_list %}
    <table id="entity_list_table" class="infotable datatable">
        <thead>
            <tr>
                <th>{% trans "No." %}</th>
                <th>{% trans 'Username' %}</th>
                <th>{% trans 'Full name' %}</th>
                <th>{% trans 'Actions' %}</th>
            </tr>
        </thead>
        <tbody>
        {% for user in object_list %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ user.username }}</td>
                <td>{{ user.get_name }}</td>
                <td>
                    {% get_obj_perms request.user for user as "bluuuser_perms" %}
                    {% if perms.accounts.change_bluuser or "change_bluuser" in bluuuser_perms %}<a href="{% url 'bluuuser_edit' user.username %}">{% trans 'Edit' %}</a>{% endif %}
                    {% if perms.accounts.delete_bluuser or "delete_bluuser" in bluuuser_perms %}<a href="{% url 'bluuuser_delete' user.username %}" onclick="return confirm('{% trans "Are you sure you want delete this user?" %}')">{% trans 'Remove' %}</a>{% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
        {% trans 'There are no users to display' %}
    {% endif %}
{% endblock %}
